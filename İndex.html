
<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cebimde Hava</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  color:white;
  text-align:center;
  transition:background 0.5s ease;
  overflow-x:hidden;
}
.container{padding:20px;}

select,button{
  padding:10px;
  margin:10px;
  border-radius:8px;
  border:none;
  font-size:16px;
}

.card{
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  padding:20px;
  border-radius:15px;
  margin:20px auto;
  max-width:400px;
}

.hourly{
  display:flex;
  overflow-x:auto;
  gap:10px;
}

.hour{
  min-width:90px;
  background:rgba(255,255,255,0.2);
  padding:10px;
  border-radius:10px;
}

.warning{
  background:#ff4d4d;
  padding:10px;
  border-radius:10px;
  margin-top:10px;
}

body.clear { background: linear-gradient(135deg,#56ccf2,#2f80ed); }
body.clouds { background: linear-gradient(135deg,#757f9a,#d7dde8); }
body.rain { background: linear-gradient(135deg,#314755,#26a0da); }
body.snow { background: linear-gradient(135deg,#e6dada,#274046); }

.snowflake{
  position:fixed;
  top:-10px;
  color:white;
  font-size:18px;
  animation:fall linear infinite;
}

@keyframes fall{
  to{ transform:translateY(100vh); }
}
</style>
</head>
<body class="clear">

<div class="container">
<h1>ğŸŒ¤ Cebimde Hava</h1>

<select id="city">
<option value="Istanbul">Ä°stanbul</option>
<option value="Ankara">Ankara</option>
<option value="Izmir">Ä°zmir</option>
<option value="Bursa">Bursa</option>
<option value="Antalya">Antalya</option>
<option value="Adana">Adana</option>
<option value="Konya">Konya</option>
<option value="Gaziantep">Gaziantep</option>
<option value="Kayseri">Kayseri</option>
<option value="Mersin">Mersin</option>
<option value="Trabzon">Trabzon</option>
<option value="Erzurum">Erzurum</option>
<option value="Van">Van</option>
<option value="Samsun">Samsun</option>
<option value="Diyarbakir">DiyarbakÄ±r</option>
<option value="Eskisehir">EskiÅŸehir</option>
<option value="Kocaeli">Kocaeli</option>
<option value="Sakarya">Sakarya</option>
<option value="Tekirdag">TekirdaÄŸ</option>
<option value="Malatya">Malatya</option>
</select>

<button onclick="getWeather()">Getir</button>

<div class="card" id="current"></div>

<div class="card">
<h3>Saatlik Tahmin</h3>
<div class="hourly" id="hourly"></div>
</div>

<div class="card" id="snow"></div>
<div id="warnings"></div>

</div>

<script>
const apiKey="4f0f2a01c4f7d40c476284eb0ef287a5";

function getWeather(){
const city=document.getElementById("city").value;

fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city},TR&units=metric&lang=tr&appid=${apiKey}`)
.then(res=>res.json())
.then(data=>{

const now=data.list[0];
const weatherType=now.weather[0].main.toLowerCase();

setBackground(weatherType);

document.getElementById("current").innerHTML=`
<h2>${data.city.name}</h2>
<p>ğŸŒ¡ï¸ ${now.main.temp}Â°C</p>
<p>â˜ï¸ ${now.weather[0].description}</p>
<p>ğŸ’§ Nem: ${now.main.humidity}%</p>
<p>ğŸ’¨ RÃ¼zgar: ${(now.wind.speed*3.6).toFixed(1)} km/sa</p>
`;

let hourlyHTML="";
let totalSnow=0;
let warningHTML="";

for(let i=0;i<8;i++){
const item=data.list[i];
const hour=item.dt_txt.split(" ")[1].slice(0,5);

hourlyHTML+=`
<div class="hour">
<div>${hour}</div>
<div>${item.main.temp}Â°C</div>
</div>
`;

if(item.snow && item.snow["3h"]){
totalSnow+=item.snow["3h"];
}

if(item.main.temp<=0){
warningHTML=`<div class="warning">âš ï¸ Don ve buzlanma riski!</div>`;
}
}

document.getElementById("hourly").innerHTML=hourlyHTML;

document.getElementById("snow").innerHTML=
totalSnow>0?
`<h3>â„ï¸ Tahmini Kar Birikimi: ${totalSnow} mm</h3>`:
`<h3>Kar beklenmiyor</h3>`;

document.getElementById("warnings").innerHTML=warningHTML;

if(totalSnow>0 || now.main.temp<=0){
if(Notification.permission==="granted"){
new Notification("Cebimde Hava UyarÄ±",{body:"Kar veya don riski var!"});
}else{
Notification.requestPermission();
}
}

if(totalSnow>0){
startSnow();
}else{
stopSnow();
}

});
}

function setBackground(type){
document.body.className="";
if(type.includes("clear")) document.body.classList.add("clear");
else if(type.includes("cloud")) document.body.classList.add("clouds");
else if(type.includes("rain")) document.body.classList.add("rain");
else if(type.includes("snow")) document.body.classList.add("snow");
}

let snowInterval;

function startSnow(){
stopSnow();
snowInterval=setInterval(()=>{
const snow=document.createElement("div");
snow.classList.add("snowflake");
snow.innerHTML="â„";
snow.style.left=Math.random()*window.innerWidth+"px";
snow.style.animationDuration=(3+Math.random()*5)+"s";
document.body.appendChild(snow);
setTimeout(()=>snow.remove(),8000);
},200);
}

function stopSnow(){
clearInterval(snowInterval);
document.querySelectorAll(".snowflake").forEach(s=>s.remove());
}
</script>

</body>
</html>
